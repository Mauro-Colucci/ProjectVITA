<%- include("./layout/header.ejs") %> 


<style>
   .card .image{
    height: 220px;
    overflow: hidden;
    border-radius: 4px 4px 0 0;
    width: 100%;
   }
   .card .image img{
    width: 100%;
   }
  .imgMargin{
    margin-top: -110px;
   }
   .avatar{
    width: 200px;
    height: 200px;
    border-radius: 50%;
    border: 5px solid #ffffff;
    margin-bottom: 15px;
    object-fit: cover;
   }

   .form-floating:focus-within {
        z-index: 2;
    }

   #floatingNewPassword{
        margin-bottom: -1px;
        border-bottom-right-radius: 0;
        border-bottom-left-radius: 0;
    }
    #floatingConfirmNewPassword{
        margin-bottom: 10px;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
    }
</style>

<main>
    <% if (locals.messages.errors) { %> 
        <% messages.errors.forEach( el => { %>
            <div class="alert alert-danger mt-2"><%= el.msg %></div>
        <% }) %> 
    <% } %>
    <div class="row mt-4">
        <div class="col-md-8">
            <div class="card">
                <h5 class="card-header">Edit Profile</h5>
                <div class="card-body">
                    <form action="/profile/<%= user._id %>?_method=PUT" enctype="multipart/form-data" method="POST">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Company</label>
                                <input type="text" class="form-control" placeholder="Company" value="Creative Code Inc.">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label  class="form-label">Username</label>
                                <input type="text" class="form-control" placeholder="Username" value="<%= user.userName %> " disabled>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Email address</label>
                                <input type="email" class="form-control" id="exampleFormControlInput1" value="<%= user.email %>" disabled>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label  class="form-label">First Name</label>
                                <input type="text" class="form-control" placeholder="Company" value="Mike">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label  class="form-label">Last Name</label>
                                <input type="text" class="form-control" placeholder="Last Name" value="Andrew">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label  class="form-label">Address</label>
                                <input type="text" class="form-control" placeholder="Home Address" value="Bld Mihail Kogalniceanu, nr. 8 Bl 1, Sc 1, Ap 09">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">City</label>
                                <input type="text" class="form-control" placeholder="City" value="Mike">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Country</label>
                                <input type="text" class="form-control" placeholder="Country" value="Andrew">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="formFile" class="form-label">Profile picture</label>
                                <input class="form-control" type="file" name="file" id="formFile">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label class="form-label">About Me</label>
                                <textarea rows="5" class="form-control" placeholder="Here can be your description" value="Mike">add a card as column bellow user card with dropdown to select users(section in for each), but only show it if you are an admin. Need to modify the form to reflect pertinent fields (all) regarding the user model. Need to to use it to fill the presentation card that could be exported?</textarea>
                            </div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-between">

                            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                Password change
                            </button>

                            <button type="submit" class="btn btn-success">Update Profile</button>

                          </div>

                        
                        <!-- password change Modal -->
                        <div class="modal fade " id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="staticBackdropLabel">Enter new password</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body mx-4">
                                    
                                      <div class="form-floating">
                                        <input type="password" class="form-control" id="floatingNewPassword" name="newPassword" placeholder="password">
                                        <label for="floatingNewPassword">New password</label>
                                      </div>
                                      <div class="form-floating">
                                        <input type="password" class="form-control" id="floatingConfirmNewPassword" name="confirmNewPassword" placeholder="password">
                                        <label for="floatingConfirmNewPassword">Confirm new password</label>
                                      </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">Accept</button>
                                </div>
                            </div>
                            </div>
                        </div>
                        <!-- end of password change Modal -->
  
                    </form>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="image">
                    <img src="/imgs/photo-1541661538396-53ba2d051eed.avif" alt="..."/>
                </div>
                <div class="content">
                    <div class="text-center imgMargin">
                        <img class="avatar" src="<%= user.avatar? user.avatar : '/imgs/defaultAvatar.webp' %>" alt="..."/>

                        <h4 class="card-title"><%= user.userName %></h4>
                        <h6 class="card-subtitle mb-2"><%= user.id %> </h6>
                    </div>
                    <p class="text-muted text-center fw-light mx-4"> 
                        Lorem, ipsum dolor sit amet consectetur adipisicing elit. Veniam, amet.
                    </p>
                </div>
                <div class="card-footer text-center">
                    <button href="#" class="btn btn-simple"><i class='bx bxl-github' ></i></button>
                    <button href="#" class="btn btn-simple"><i class='bx bxl-twitter'></i></button>
                    <button href="#" class="btn btn-simple"><i class='bx bxl-linkedin-square' ></i></button>
                </div>
            </div>
            
            <select name="selectOption" class="form-select mt-4" aria-label="Default select example">
                <option selected>Select user</option>
                <% selection?.forEach(element => { %>
                <option value="<%= element._id %>"><%= element.userName %> </option>
                <% }) %>

            </select>

        </div>

    </div>
</main>

<%- include('layout/footer.ejs') %> 
